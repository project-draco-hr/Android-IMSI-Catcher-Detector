{
  int token;
  if (mMessages.size() > MAX_MESSAGES) {
    Log.e(TAG,mTAG + " message queue is full");
    return;
  }
  if (mOutputStream == null) {
    Log.e(TAG,mTAG + " Local write() error: not connected");
    return;
  }
  do {
    token=mTokenGen.nextInt();
  }
 while (mMessages.containsKey(token));
  byte req[]=marshallRequest(token,data);
  if (DBG) {
    Log.v(TAG,String.format("invokeOemRilRequestRaw() token: 0x%X, header: %s, req: %s ",token,HexDump.toHexString(getHeader(req)),HexDump.toHexString(req)));
  }
  mOutputStream.write(getHeader(req));
  mOutputStream.write(req);
  mMessages.put(token,response);
}
