{
  if (!cellInDbiBts(cell.getLAC(),cell.getCID())) {
    ContentValues values=new ContentValues();
    values.put(DBTableColumnIds.DBI_BTS_MCC,cell.getMCC());
    values.put(DBTableColumnIds.DBI_BTS_MNC,cell.getMNC());
    values.put(DBTableColumnIds.DBI_BTS_LAC,cell.getLAC());
    values.put(DBTableColumnIds.DBI_BTS_CID,cell.getCID());
    values.put(DBTableColumnIds.DBI_BTS_PSC,cell.getPSC());
    values.put(DBTableColumnIds.DBI_BTS_TIME_FIRST,String.valueOf(System.currentTimeMillis()));
    values.put(DBTableColumnIds.DBI_BTS_TIME_LAST,String.valueOf(System.currentTimeMillis()));
    values.put(DBTableColumnIds.DBI_BTS_LAT,cell.getLat());
    values.put(DBTableColumnIds.DBI_BTS_LON,cell.getLon());
    mDb.insert(DBTableColumnIds.DBI_BTS_TABLE_NAME,null,values);
    Log.i(mTAG,"DBi_bts inserted");
  }
 else {
    ContentValues values=new ContentValues();
    values.put(DBTableColumnIds.DBI_BTS_TIME_LAST,String.valueOf(System.currentTimeMillis()));
    if (cell.getLat() != 0.0 && cell.getLat() != 0 && cell.getLon() != 0.0 && cell.getLon() != 0) {
      values.put(DBTableColumnIds.DBI_BTS_LAT,cell.getLat());
      values.put(DBTableColumnIds.DBI_BTS_LON,cell.getLon());
    }
    mDb.update(DBTableColumnIds.DBI_BTS_TABLE_NAME,values,"CID=?",new String[]{Integer.toString(cell.getCID())});
    Log.i(mTAG,"DBi_bts Updated Cid=" + cell.getCID() + " Lac="+ cell.getLAC());
  }
  if (!cellInDbiMeasure(cell.getCID())) {
    ContentValues dbiMeasure=new ContentValues();
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_BTS_ID,cell.getCID());
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_NC_LIST,"no_data");
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_TIME,String.valueOf(System.currentTimeMillis()));
    String slat=String.valueOf(cell.getLat());
    String slon=String.valueOf(cell.getLon());
    if (slat == null) {
      slat="0.0";
    }
    if (slon == null) {
      slat="0.0";
    }
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_GPSD_LAT,slat);
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_GPSD_LON,slon);
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_GPSD_ACCURACY,cell.getAccuracy());
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_BB_POWER,String.valueOf(cell.getDBM()));
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_TX_POWER,"0");
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_RX_SIGNAL,"0");
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_RAT,String.valueOf(cell.getNetType()));
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_TA,cell.getTimingAdvance());
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_BER,0);
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_IS_SUBMITTED,0);
    dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_IS_NEIGHBOUR,0);
    mDb.insert(DBTableColumnIds.DBI_MEASURE_TABLE_NAME,null,dbiMeasure);
    Log.i(mTAG,"DBi_measure inserted bts_id=" + cell.getCID());
  }
 else {
    ContentValues dbiMeasure=new ContentValues();
    if (cell.getLat() != 0.0 && cell.getLon() != 0.0) {
      dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_GPSD_LAT,cell.getLat());
      dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_GPSD_LON,cell.getLon());
    }
    if (cell.getAccuracy() != 0.0 && cell.getAccuracy() > 0) {
      dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_GPSD_ACCURACY,cell.getAccuracy());
    }
    if (cell.getDBM() > 0) {
      dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_BB_POWER,String.valueOf(cell.getDBM()));
    }
    if (cell.getTimingAdvance() > 0) {
      dbiMeasure.put(DBTableColumnIds.DBI_MEASURE_TA,cell.getTimingAdvance());
    }
    mDb.update(DBTableColumnIds.DBI_MEASURE_TABLE_NAME,dbiMeasure,"bts_id=?",new String[]{Integer.toString(cell.getCID())});
    Log.i(mTAG,"DBi_measure updated bts_id=" + cell.getCID());
  }
}
