{
  if (!terminated) {
synchronized (this) {
      if (mHandler != null && handlerEnabled) {
        Message msg=mHandler.obtainMessage();
        Bundle bundle=new Bundle();
        bundle.putInt(CommandHandler.ACTION,CommandHandler.COMMAND_COMPLETED);
        msg.setData(bundle);
        mHandler.sendMessage(msg);
      }
 else {
        commandCompleted(id,exitCode);
      }
      RootTools.log("Command " + id + " finished.");
      finishCommand();
    }
  }
}
