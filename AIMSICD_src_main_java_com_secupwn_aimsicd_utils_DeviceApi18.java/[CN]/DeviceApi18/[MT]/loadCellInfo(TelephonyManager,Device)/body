{
  int lCurrentApiVersion=Build.VERSION.SDK_INT;
  try {
    if (pDevice.mCell == null) {
      pDevice.mCell=new Cell();
    }
    List<CellInfo> cellInfoList=tm.getAllCellInfo();
    if (cellInfoList != null) {
      for (      final CellInfo info : cellInfoList) {
        pDevice.mCell.setNetType(tm.getNetworkType());
        if (info instanceof CellInfoGsm) {
          final CellSignalStrengthGsm gsm=((CellInfoGsm)info).getCellSignalStrength();
          final CellIdentityGsm identityGsm=((CellInfoGsm)info).getCellIdentity();
          pDevice.mCell.setDbm(gsm.getDbm());
          pDevice.mCell.setCid(identityGsm.getCid());
          pDevice.mCell.setMcc(identityGsm.getMcc());
          pDevice.mCell.setMnc(identityGsm.getMnc());
          pDevice.mCell.setLac(identityGsm.getLac());
        }
 else         if (info instanceof CellInfoCdma) {
          final CellSignalStrengthCdma cdma=((CellInfoCdma)info).getCellSignalStrength();
          final CellIdentityCdma identityCdma=((CellInfoCdma)info).getCellIdentity();
          pDevice.mCell.setDbm(cdma.getDbm());
          pDevice.mCell.setCid(identityCdma.getBasestationId());
          pDevice.mCell.setMnc(identityCdma.getSystemId());
          pDevice.mCell.setLac(identityCdma.getNetworkId());
          pDevice.mCell.setSid(identityCdma.getSystemId());
        }
 else         if (info instanceof CellInfoLte) {
          final CellSignalStrengthLte lte=((CellInfoLte)info).getCellSignalStrength();
          final CellIdentityLte identityLte=((CellInfoLte)info).getCellIdentity();
          pDevice.mCell.setDbm(lte.getDbm());
          pDevice.mCell.setTimingAdvance(lte.getTimingAdvance());
          pDevice.mCell.setMcc(identityLte.getMcc());
          pDevice.mCell.setMnc(identityLte.getMnc());
          pDevice.mCell.setCid(identityLte.getCi());
        }
 else         if (lCurrentApiVersion >= Build.VERSION_CODES.JELLY_BEAN_MR2 && info instanceof CellInfoWcdma) {
          final CellSignalStrengthWcdma wcdma=((CellInfoWcdma)info).getCellSignalStrength();
          final CellIdentityWcdma identityWcdma=((CellInfoWcdma)info).getCellIdentity();
          pDevice.mCell.setDbm(wcdma.getDbm());
          pDevice.mCell.setLac(identityWcdma.getLac());
          pDevice.mCell.setMcc(identityWcdma.getMcc());
          pDevice.mCell.setMnc(identityWcdma.getMnc());
          pDevice.mCell.setCid(identityWcdma.getCid());
          pDevice.mCell.setPsc(identityWcdma.getPsc());
        }
 else {
          log.info("Unknown type of cell signal!" + "\n ClassName: " + info.getClass().getSimpleName() + "\n ToString: "+ info.toString());
        }
        if (pDevice.mCell.isValid()) {
          break;
        }
      }
    }
  }
 catch (  NullPointerException npe) {
    log.error("loadCellInfo: Unable to obtain cell signal information: ",npe);
  }
}
