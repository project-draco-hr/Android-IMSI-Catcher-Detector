{
  Log.i(TAG,"Sending shell \"" + command + "\", wait "+ maxWaitSeconds+ " seconds");
  if (!mShellOpened) {
    return false;
  }
  if (mShellStdIn == null) {
    return false;
  }
  if (mShellStdOut == null) {
    return false;
  }
  if (mShellStdErr == null) {
    return false;
  }
  clearStdOutAndErr();
  try {
    int oldCount;
    try {
      oldCount=mShellStdOut.available() + mShellStdErr.available();
    }
 catch (    IOException ioe) {
      oldCount=0;
    }
    mShellStdIn.writeBytes(command + "\n");
    mShellStdIn.flush();
    for (int waitCount=0; waitCount <= Math.round(maxWaitSeconds * 10); waitCount++) {
      int currCount;
      try {
        currCount=mShellStdOut.available() + mShellStdErr.available();
      }
 catch (      IOException ioe) {
        currCount=0;
      }
      Log.i(TAG,"Waiting for command return, idx = " + waitCount + ", old = "+ oldCount+ ", curr = "+ currCount);
      if (currCount != oldCount) {
        Log.i(TAG,"Command returned");
        break;
      }
      SystemClock.sleep(100);
    }
  }
 catch (  IOException ioe) {
    Log.i(TAG,"Send shell failed - " + ioe.getMessage());
    return false;
  }
  return true;
}
